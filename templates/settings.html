{% extends "base.html" %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2><i class="fas fa-cogs me-2"></i>Settings</h2>
                <a href="{{ url_for('index') }}" class="btn btn-outline-primary">
                    <i class="fas fa-arrow-left me-1"></i>Back to Dashboard
                </a>
            </div>

            <div class="row">
                <div class="col-lg-8">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-sliders-h me-2"></i>Analysis Settings</h5>
                        </div>
                        <div class="card-body">
                            <form method="POST">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="support_threshold" class="form-label">
                                                <i class="fas fa-chart-line me-1"></i>Support Threshold (%)
                                            </label>
                                            <input type="number" 
                                                   class="form-control" 
                                                   id="support_threshold" 
                                                   name="support_threshold" 
                                                   value="{{ settings.support_threshold }}" 
                                                   min="0.1" 
                                                   max="50.0" 
                                                   step="0.1"
                                                   required>
                                            <div class="form-text">Distance from support levels to show stocks (0.1% - 50%)</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="resistance_threshold" class="form-label">
                                                <i class="fas fa-chart-line me-1"></i>Resistance Threshold (%)
                                            </label>
                                            <input type="number" 
                                                   class="form-control" 
                                                   id="resistance_threshold" 
                                                   name="resistance_threshold" 
                                                   value="{{ settings.resistance_threshold }}" 
                                                   min="0.1" 
                                                   max="50.0" 
                                                   step="0.1"
                                                   required>
                                            <div class="form-text">Distance from resistance levels to show stocks (0.1% - 50%)</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="level_type" class="form-label">
                                                <i class="fas fa-layer-group me-1"></i>Level Type
                                            </label>
                                            <select class="form-select" id="level_type" name="level_type">
                                                <option value="support" {% if settings.level_type == 'support' %}selected{% endif %}>Support Levels</option>
                                                <option value="resistance" {% if settings.level_type == 'resistance' %}selected{% endif %}>Resistance Levels</option>
                                            </select>
                                            <div class="form-text">Choose which type of levels to analyze by default</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="sector_filter" class="form-label">
                                                <i class="fas fa-filter me-1"></i>Default Sector Filter
                                            </label>
                                            <select class="form-select" id="sector_filter" name="sector_filter">
                                                <option value="All" {% if settings.sector_filter == 'All' %}selected{% endif %}>All Sectors</option>
                                                {% for sector in all_sectors %}
                                                <option value="{{ sector }}" {% if settings.sector_filter == sector %}selected{% endif %}>{{ sector }}</option>
                                                {% endfor %}
                                            </select>
                                            <div class="form-text">Default sector to filter by</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="sort_by" class="form-label">
                                                <i class="fas fa-sort me-1"></i>Default Sort By
                                            </label>
                                            <select class="form-select" id="sort_by" name="sort_by">
                                                <option value="ticker" {% if settings.sort_by == 'ticker' %}selected{% endif %}>Ticker Symbol</option>
                                                <option value="price" {% if settings.sort_by == 'price' %}selected{% endif %}>Price</option>
                                                <option value="distance" {% if settings.sort_by == 'distance' %}selected{% endif %}>Distance from Level</option>
                                                <option value="popularity" {% if settings.sort_by == 'popularity' %}selected{% endif %}>Popularity</option>
                                            </select>
                                            <div class="form-text">Default sorting criteria</div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="sort_order" class="form-label">
                                                <i class="fas fa-sort-alpha-down me-1"></i>Default Sort Order
                                            </label>
                                            <select class="form-select" id="sort_order" name="sort_order">
                                                <option value="asc" {% if settings.sort_order == 'asc' %}selected{% endif %}>Ascending</option>
                                                <option value="desc" {% if settings.sort_order == 'desc' %}selected{% endif %}>Descending</option>
                                            </select>
                                            <div class="form-text">Default sorting order</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="d-grid">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save me-1"></i>Save Settings
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>About Settings</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <h6><i class="fas fa-chart-line me-1"></i>Thresholds</h6>
                                <p class="small text-muted">Support and resistance thresholds determine how close a stock's current price must be to a support or resistance level to be included in the results. Lower values show fewer, more precise matches.</p>
                            </div>

                            <div class="mb-3">
                                <h6><i class="fas fa-layer-group me-1"></i>Level Types</h6>
                                <p class="small text-muted"><strong>Support:</strong> Price levels where stocks tend to bounce up from.<br>
                                <strong>Resistance:</strong> Price levels where stocks tend to bounce down from.</p>
                            </div>

                            <div class="mb-3">
                                <h6><i class="fas fa-filter me-1"></i>Sectors</h6>
                                <p class="small text-muted">Filter results by industry sector to focus on specific market segments. "All" shows results from all sectors including crypto.</p>
                            </div>

                            <div class="mb-3">
                                <h6><i class="fas fa-sort me-1"></i>Sorting</h6>
                                <p class="small text-muted">Choose how results are ordered by default. Distance sorting shows stocks closest to their support/resistance levels first.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}